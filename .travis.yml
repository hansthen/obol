sudo: required

language: python

python:
  - "2.6"
  - "2.7"

services:
  - docker

before_install:
- docker pull pythea/ldap
- docker run -d --net=host --name ldap pythea/ldap 
- docker ps -a
- sudo apt -y install ldap-utils python-flake8
- git clone https://github.com/sstephenson/bats.git && sudo bats/install.sh /usr/local
- docker logs ldap

install:
- sudo pip install -r requirements.txt
- sudo python setup.py -q install 

script:
- flake8 obol
- bats tests/tests

deploy:
  provider: pypi
  user: "Your username"
  password: "Your password"
  on:
    tags: true
